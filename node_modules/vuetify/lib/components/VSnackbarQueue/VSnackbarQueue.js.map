{"version":3,"file":"VSnackbarQueue.js","names":["VBtn","VDefaultsProvider","makeVSnackbarProps","VSnackbar","useLocale","computed","nextTick","shallowRef","watch","genericComponent","omit","propsFactory","useRender","makeVSnackbarQueueProps","closable","Boolean","String","closeText","type","default","modelValue","Array","VSnackbarQueue","name","props","emits","val","setup","emit","slots","t","isActive","isVisible","current","length","oldVal","value","showNext","onAfterLeave","undefined","next","rest","text","onClickClose","btnProps","color","hasActions","actions","_","snackbarProps","filterProps","_createElementVNode","_Fragment","_createVNode","item","_mergeProps","$event","onClick"],"sources":["../../../src/components/VSnackbarQueue/VSnackbarQueue.tsx"],"sourcesContent":["// Components\nimport { VBtn } from '@/components/VBtn'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { makeVSnackbarProps, VSnackbar } from '@/components/VSnackbar/VSnackbar'\n\n// Composables\nimport { useLocale } from '@/composables/locale'\n\n// Utilities\nimport { computed, nextTick, shallowRef, watch } from 'vue'\nimport { genericComponent, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { PropType, VNodeProps } from 'vue'\nimport type { GenericProps } from '@/util'\n\nexport type VSnackbarQueueSlots<T extends string | SnackbarMessage> = {\n  default: { item: T }\n  text: { item: T }\n  actions: {\n    item: T\n    props: {\n      onClick: () => void\n    }\n  }\n}\n\nexport type SnackbarMessage =\n  | string\n  | (Omit<\n    VSnackbar['$props'],\n    | 'modelValue'\n    | 'onUpdate:modelValue'\n    | 'activator'\n    | 'activatorProps'\n    | 'closeDelay'\n    | 'openDelay'\n    | 'openOnClick'\n    | 'openOnFocus'\n    | 'openOnHover'\n    | 'style'\n    | '$children'\n    | 'v-slots'\n    | `v-slot:${string}`\n    | keyof VNodeProps\n  > & { style?: any })\n\nexport const makeVSnackbarQueueProps = propsFactory({\n  // TODO: Port this to Snackbar on dev\n  closable: [Boolean, String],\n  closeText: {\n    type: String,\n    default: '$vuetify.dismiss',\n  },\n  modelValue: {\n    type: Array as PropType<readonly SnackbarMessage[]>,\n    default: () => [],\n  },\n\n  ...omit(makeVSnackbarProps(), ['modelValue']),\n}, 'VSnackbarQueue')\n\nexport const VSnackbarQueue = genericComponent<new <T extends readonly SnackbarMessage[]> (\n  props: {\n    modelValue?: T\n    'onUpdate:modelValue'?: (val: T) => void\n  },\n  slots: VSnackbarQueueSlots<T[number]>,\n) => GenericProps<typeof props, typeof slots>>()({\n  name: 'VSnackbarQueue',\n\n  props: makeVSnackbarQueueProps(),\n\n  emits: {\n    'update:modelValue': (val: SnackbarMessage[]) => true,\n  },\n\n  setup (props, { emit, slots }) {\n    const { t } = useLocale()\n\n    const isActive = shallowRef(false)\n    const isVisible = shallowRef(false)\n    const current = shallowRef<Exclude<SnackbarMessage, string>>()\n\n    watch(() => props.modelValue.length, (val, oldVal) => {\n      if (!isVisible.value && val > oldVal) {\n        showNext()\n      }\n    })\n    watch(isActive, val => {\n      if (val) isVisible.value = true\n    })\n\n    function onAfterLeave () {\n      if (props.modelValue.length) {\n        showNext()\n      } else {\n        current.value = undefined\n        isVisible.value = false\n      }\n    }\n    function showNext () {\n      const [next, ...rest] = props.modelValue\n      emit('update:modelValue', rest)\n      current.value = typeof next === 'string' ? { text: next } : next\n      nextTick(() => {\n        isActive.value = true\n      })\n    }\n    function onClickClose () {\n      isActive.value = false\n    }\n\n    const btnProps = computed(() => ({\n      color: typeof props.closable === 'string' ? props.closable : undefined,\n      text: t(props.closeText),\n    }))\n\n    useRender(() => {\n      const hasActions = !!(props.closable || slots.actions)\n      const { modelValue: _, ...snackbarProps } = VSnackbar.filterProps(props as any)\n\n      return (\n        <>\n          { isVisible.value && !!current.value && (\n            slots.default\n              ? (\n                <VDefaultsProvider defaults={{ VSnackbar: current.value }}>\n                  { slots.default({ item: current.value }) }\n                </VDefaultsProvider>\n              ) : (\n                <VSnackbar\n                  { ...snackbarProps }\n                  { ...current.value }\n                  v-model={ isActive.value }\n                  onAfterLeave={ onAfterLeave }\n                >\n                  {{\n                    text: slots.text ? () => slots.text?.({ item: current.value! }) : undefined,\n                    actions: hasActions ? () => (\n                      <>\n                        { !slots.actions ? (\n                          <VBtn\n                            { ...btnProps.value }\n                            onClick={ onClickClose }\n                          />\n                        ) : (\n                          <VDefaultsProvider\n                            defaults={{\n                              VBtn: btnProps.value,\n                            }}\n                          >\n                            { slots.actions({\n                              item: current.value!,\n                              props: { onClick: onClickClose },\n                            })}\n                          </VDefaultsProvider>\n                        )}\n                      </>\n                    ) : undefined,\n                  }}\n                </VSnackbar>\n              )\n          )}\n        </>\n      )\n    })\n  },\n})\n\nexport type VSnackbarQueue = InstanceType<typeof VSnackbarQueue>\n"],"mappings":"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","ignoreList":[]}