{"version":3,"file":"VForm.js","names":["makeComponentProps","createForm","makeFormProps","forwardRefs","ref","genericComponent","propsFactory","useRender","makeVFormProps","VForm","name","props","emits","val","submit","e","setup","slots","emit","form","formRef","onReset","preventDefault","reset","onSubmit","_e","ready","validate","then","bind","catch","finally","defaultPrevented","valid","value","_createElementVNode","_normalizeClass","class","_normalizeStyle","style","default","errors","isDisabled","isReadonly","isValidating","isValid","items","resetValidation"],"sources":["../../../src/components/VForm/VForm.tsx"],"sourcesContent":["// Composables\nimport { makeComponentProps } from '@/composables/component'\nimport { createForm, makeFormProps } from '@/composables/form'\nimport { forwardRefs } from '@/composables/forwardRefs'\n\n// Utilities\nimport { ref } from 'vue'\nimport { genericComponent, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { FieldValidationResult, FormField, FormValidationResult, SubmitEventPromise } from '@/composables/form'\n\nexport const makeVFormProps = propsFactory({\n  ...makeComponentProps(),\n  ...makeFormProps(),\n}, 'VForm')\n\ntype VFormSlots = {\n  default: {\n    errors: FieldValidationResult[]\n    isDisabled: boolean\n    isReadonly: boolean\n    isValidating: boolean\n    isValid: boolean | null\n    items: FormField[]\n    validate: () => Promise<FormValidationResult>\n    reset: () => void\n    resetValidation: () => void\n  }\n}\n\nexport const VForm = genericComponent<VFormSlots>()({\n  name: 'VForm',\n\n  props: makeVFormProps(),\n\n  emits: {\n    'update:modelValue': (val: boolean | null) => true,\n    submit: (e: SubmitEventPromise) => true,\n  },\n\n  setup (props, { slots, emit }) {\n    const form = createForm(props)\n    const formRef = ref<HTMLFormElement>()\n\n    function onReset (e: Event) {\n      e.preventDefault()\n      form.reset()\n    }\n\n    function onSubmit (_e: Event) {\n      const e = _e as SubmitEventPromise\n\n      const ready = form.validate()\n      e.then = ready.then.bind(ready)\n      e.catch = ready.catch.bind(ready)\n      e.finally = ready.finally.bind(ready)\n\n      emit('submit', e)\n\n      if (!e.defaultPrevented) {\n        ready.then(({ valid }) => {\n          if (valid) {\n            formRef.value?.submit()\n          }\n        })\n      }\n\n      e.preventDefault()\n    }\n\n    useRender(() => ((\n      <form\n        ref={ formRef }\n        class={[\n          'v-form',\n          props.class,\n        ]}\n        style={ props.style }\n        novalidate\n        onReset={ onReset }\n        onSubmit={ onSubmit }\n      >\n        { slots.default?.({\n          errors: form.errors.value,\n          isDisabled: form.isDisabled.value,\n          isReadonly: form.isReadonly.value,\n          isValidating: form.isValidating.value,\n          isValid: form.isValid.value,\n          items: form.items.value,\n          validate: form.validate,\n          reset: form.reset,\n          resetValidation: form.resetValidation,\n        })}\n      </form>\n    )))\n\n    return forwardRefs(form, formRef)\n  },\n})\n\nexport type VForm = InstanceType<typeof VForm>\n"],"mappings":";AAAA;AAAA,SACSA,kBAAkB;AAAA,SAClBC,UAAU,EAAEC,aAAa;AAAA,SACzBC,WAAW,4CAEpB;AACA,SAASC,GAAG,QAAQ,KAAK;AAAA,SAChBC,gBAAgB,EAAEC,YAAY,EAAEC,SAAS,+BAElD;AAGA,OAAO,MAAMC,cAAc,GAAGF,YAAY,CAAC;EACzC,GAAGN,kBAAkB,CAAC,CAAC;EACvB,GAAGE,aAAa,CAAC;AACnB,CAAC,EAAE,OAAO,CAAC;AAgBX,OAAO,MAAMO,KAAK,GAAGJ,gBAAgB,CAAa,CAAC,CAAC;EAClDK,IAAI,EAAE,OAAO;EAEbC,KAAK,EAAEH,cAAc,CAAC,CAAC;EAEvBI,KAAK,EAAE;IACL,mBAAmB,EAAGC,GAAmB,IAAK,IAAI;IAClDC,MAAM,EAAGC,CAAqB,IAAK;EACrC,CAAC;EAEDC,KAAKA,CAAEL,KAAK,EAAE;IAAEM,KAAK;IAAEC;EAAK,CAAC,EAAE;IAC7B,MAAMC,IAAI,GAAGlB,UAAU,CAACU,KAAK,CAAC;IAC9B,MAAMS,OAAO,GAAGhB,GAAG,CAAkB,CAAC;IAEtC,SAASiB,OAAOA,CAAEN,CAAQ,EAAE;MAC1BA,CAAC,CAACO,cAAc,CAAC,CAAC;MAClBH,IAAI,CAACI,KAAK,CAAC,CAAC;IACd;IAEA,SAASC,QAAQA,CAAEC,EAAS,EAAE;MAC5B,MAAMV,CAAC,GAAGU,EAAwB;MAElC,MAAMC,KAAK,GAAGP,IAAI,CAACQ,QAAQ,CAAC,CAAC;MAC7BZ,CAAC,CAACa,IAAI,GAAGF,KAAK,CAACE,IAAI,CAACC,IAAI,CAACH,KAAK,CAAC;MAC/BX,CAAC,CAACe,KAAK,GAAGJ,KAAK,CAACI,KAAK,CAACD,IAAI,CAACH,KAAK,CAAC;MACjCX,CAAC,CAACgB,OAAO,GAAGL,KAAK,CAACK,OAAO,CAACF,IAAI,CAACH,KAAK,CAAC;MAErCR,IAAI,CAAC,QAAQ,EAAEH,CAAC,CAAC;MAEjB,IAAI,CAACA,CAAC,CAACiB,gBAAgB,EAAE;QACvBN,KAAK,CAACE,IAAI,CAAC,CAAC;UAAEK;QAAM,CAAC,KAAK;UACxB,IAAIA,KAAK,EAAE;YACTb,OAAO,CAACc,KAAK,EAAEpB,MAAM,CAAC,CAAC;UACzB;QACF,CAAC,CAAC;MACJ;MAEAC,CAAC,CAACO,cAAc,CAAC,CAAC;IACpB;IAEAf,SAAS,CAAC,MAAA4B,mBAAA;MAAA,OAEAf,OAAO;MAAA,SAAAgB,eAAA,CACN,CACL,QAAQ,EACRzB,KAAK,CAAC0B,KAAK,CACZ;MAAA,SAAAC,eAAA,CACO3B,KAAK,CAAC4B,KAAK;MAAA;MAAA,WAETlB,OAAO;MAAA,YACNG;IAAQ,IAEjBP,KAAK,CAACuB,OAAO,GAAG;MAChBC,MAAM,EAAEtB,IAAI,CAACsB,MAAM,CAACP,KAAK;MACzBQ,UAAU,EAAEvB,IAAI,CAACuB,UAAU,CAACR,KAAK;MACjCS,UAAU,EAAExB,IAAI,CAACwB,UAAU,CAACT,KAAK;MACjCU,YAAY,EAAEzB,IAAI,CAACyB,YAAY,CAACV,KAAK;MACrCW,OAAO,EAAE1B,IAAI,CAAC0B,OAAO,CAACX,KAAK;MAC3BY,KAAK,EAAE3B,IAAI,CAAC2B,KAAK,CAACZ,KAAK;MACvBP,QAAQ,EAAER,IAAI,CAACQ,QAAQ;MACvBJ,KAAK,EAAEJ,IAAI,CAACI,KAAK;MACjBwB,eAAe,EAAE5B,IAAI,CAAC4B;IACxB,CAAC,CAAC,EAEJ,CAAC;IAEH,OAAO5C,WAAW,CAACgB,IAAI,EAAEC,OAAO,CAAC;EACnC;AACF,CAAC,CAAC","ignoreList":[]}