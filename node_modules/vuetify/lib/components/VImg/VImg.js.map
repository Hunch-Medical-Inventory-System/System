{"version":3,"file":"VImg.js","names":["makeVResponsiveProps","VResponsive","useBackgroundColor","makeComponentProps","makeRoundedProps","useRounded","makeTransitionProps","MaybeTransition","vIntersect","computed","nextTick","onBeforeMount","onBeforeUnmount","ref","shallowRef","toRef","vShow","watch","withDirectives","convertToUnit","filterInputAttrs","genericComponent","getCurrentInstance","propsFactory","SUPPORTS_INTERSECTION","useRender","makeVImgProps","absolute","Boolean","alt","String","cover","color","draggable","type","default","undefined","eager","gradient","lazySrc","options","Object","root","rootMargin","threshold","sizes","src","crossorigin","referrerpolicy","srcset","position","VImg","name","directives","inheritAttrs","props","emits","loadstart","value","load","error","setup","attrs","emit","slots","backgroundColorClasses","backgroundColorStyles","roundedClasses","vm","currentSrc","image","state","naturalWidth","naturalHeight","normalisedSrc","aspect","Number","aspectRatio","init","val","oldVal","pollForSize","isIntersecting","lazyImg","Image","setTimeout","isUnmounted","complete","onError","onLoad","getSrc","img","timer","clearTimeout","timeout","poll","imgHeight","imgWidth","window","endsWith","startsWith","containClasses","__image","_createElementVNode","_normalizeClass","objectPosition","sources","_createVNode","transition","__preloadImage","__placeholder","placeholder","__error","__gradient","backgroundImage","isBooted","stop","requestAnimationFrame","responsiveProps","filterProps","rootAttrs","imageAttrs","_withDirectives","_mergeProps","class","width","style","additional","_Fragment","handler","once"],"sources":["../../../src/components/VImg/VImg.tsx"],"sourcesContent":["// Styles\nimport './VImg.sass'\n\n// Components\nimport { makeVResponsiveProps, VResponsive } from '@/components/VResponsive/VResponsive'\n\n// Composables\nimport { useBackgroundColor } from '@/composables/color'\nimport { makeComponentProps } from '@/composables/component'\nimport { makeRoundedProps, useRounded } from '@/composables/rounded'\nimport { makeTransitionProps, MaybeTransition } from '@/composables/transition'\n\n// Directives\nimport vIntersect from '@/directives/intersect'\n\n// Utilities\nimport {\n  computed,\n  nextTick,\n  onBeforeMount,\n  onBeforeUnmount,\n  ref,\n  shallowRef,\n  toRef,\n  vShow,\n  watch,\n  withDirectives,\n} from 'vue'\nimport {\n  convertToUnit,\n  filterInputAttrs,\n  genericComponent,\n  getCurrentInstance,\n  propsFactory,\n  SUPPORTS_INTERSECTION,\n  useRender,\n} from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\n// not intended for public use, this is passed in by vuetify-loader\nexport interface srcObject {\n  src?: string\n  srcset?: string\n  lazySrc?: string\n  aspect: number\n}\n\nexport type VImgSlots = {\n  default: never\n  placeholder: never\n  error: never\n  sources: never\n}\n\nexport const makeVImgProps = propsFactory({\n  absolute: Boolean,\n  alt: String,\n  cover: Boolean,\n  color: String,\n  draggable: {\n    type: [Boolean, String] as PropType<boolean | 'true' | 'false'>,\n    default: undefined,\n  },\n  eager: Boolean,\n  gradient: String,\n  lazySrc: String,\n  options: {\n    type: Object as PropType<IntersectionObserverInit>,\n    // For more information on types, navigate to:\n    // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\n    default: () => ({\n      root: undefined,\n      rootMargin: undefined,\n      threshold: undefined,\n    }),\n  },\n  sizes: String,\n  src: {\n    type: [String, Object] as PropType<string | srcObject>,\n    default: '',\n  },\n  crossorigin: String as PropType<'' | 'anonymous' | 'use-credentials'>,\n  referrerpolicy: String as PropType<\n    | 'no-referrer'\n    | 'no-referrer-when-downgrade'\n    | 'origin'\n    | 'origin-when-cross-origin'\n    | 'same-origin'\n    | 'strict-origin'\n    | 'strict-origin-when-cross-origin'\n    | 'unsafe-url'\n  >,\n  srcset: String,\n  position: String,\n\n  ...makeVResponsiveProps(),\n  ...makeComponentProps(),\n  ...makeRoundedProps(),\n  ...makeTransitionProps(),\n}, 'VImg')\n\nexport const VImg = genericComponent<VImgSlots>()({\n  name: 'VImg',\n\n  directives: { vIntersect },\n\n  inheritAttrs: false,\n\n  props: makeVImgProps(),\n\n  emits: {\n    loadstart: (value: string | undefined) => true,\n    load: (value: string | undefined) => true,\n    error: (value: string | undefined) => true,\n  },\n\n  setup (props, { attrs, emit, slots }) {\n    const { backgroundColorClasses, backgroundColorStyles } = useBackgroundColor(() => props.color)\n    const { roundedClasses } = useRounded(props)\n    const vm = getCurrentInstance('VImg')\n\n    const currentSrc = shallowRef('') // Set from srcset\n    const image = ref<HTMLImageElement>()\n    const state = shallowRef<'idle' | 'loading' | 'loaded' | 'error'>(props.eager ? 'loading' : 'idle')\n    const naturalWidth = shallowRef<number>()\n    const naturalHeight = shallowRef<number>()\n\n    const normalisedSrc = computed<srcObject>(() => {\n      return props.src && typeof props.src === 'object'\n        ? {\n          src: props.src.src,\n          srcset: props.srcset || props.src.srcset,\n          lazySrc: props.lazySrc || props.src.lazySrc,\n          aspect: Number(props.aspectRatio || props.src.aspect || 0),\n        } : {\n          src: props.src,\n          srcset: props.srcset,\n          lazySrc: props.lazySrc,\n          aspect: Number(props.aspectRatio || 0),\n        }\n    })\n    const aspectRatio = computed(() => {\n      return normalisedSrc.value.aspect || naturalWidth.value! / naturalHeight.value! || 0\n    })\n\n    watch(() => props.src, () => {\n      init(state.value !== 'idle')\n    })\n    watch(aspectRatio, (val, oldVal) => {\n      if (!val && oldVal && image.value) {\n        pollForSize(image.value)\n      }\n    })\n\n    // TODO: getSrc when window width changes\n\n    onBeforeMount(() => init())\n\n    function init (isIntersecting?: boolean) {\n      if (props.eager && isIntersecting) return\n      if (\n        SUPPORTS_INTERSECTION &&\n        !isIntersecting &&\n        !props.eager\n      ) return\n\n      state.value = 'loading'\n\n      if (normalisedSrc.value.lazySrc) {\n        const lazyImg = new Image()\n        lazyImg.src = normalisedSrc.value.lazySrc\n        pollForSize(lazyImg, null)\n      }\n\n      if (!normalisedSrc.value.src) return\n\n      nextTick(() => {\n        emit('loadstart', image.value?.currentSrc || normalisedSrc.value.src)\n\n        setTimeout(() => {\n          if (vm.isUnmounted) return\n\n          if (image.value?.complete) {\n            if (!image.value.naturalWidth) {\n              onError()\n            }\n\n            if (state.value === 'error') return\n\n            if (!aspectRatio.value) pollForSize(image.value, null)\n            if (state.value === 'loading') onLoad()\n          } else {\n            if (!aspectRatio.value) pollForSize(image.value!)\n            getSrc()\n          }\n        })\n      })\n    }\n\n    function onLoad () {\n      if (vm.isUnmounted) return\n\n      getSrc()\n      pollForSize(image.value!)\n      state.value = 'loaded'\n      emit('load', image.value?.currentSrc || normalisedSrc.value.src)\n    }\n\n    function onError () {\n      if (vm.isUnmounted) return\n\n      state.value = 'error'\n      emit('error', image.value?.currentSrc || normalisedSrc.value.src)\n    }\n\n    function getSrc () {\n      const img = image.value\n      if (img) currentSrc.value = img.currentSrc || img.src\n    }\n\n    let timer = -1\n\n    onBeforeUnmount(() => {\n      clearTimeout(timer)\n    })\n\n    function pollForSize (img: HTMLImageElement, timeout: number | null = 100) {\n      const poll = () => {\n        clearTimeout(timer)\n        if (vm.isUnmounted) return\n\n        const { naturalHeight: imgHeight, naturalWidth: imgWidth } = img\n\n        if (imgHeight || imgWidth) {\n          naturalWidth.value = imgWidth\n          naturalHeight.value = imgHeight\n        } else if (!img.complete && state.value === 'loading' && timeout != null) {\n          timer = window.setTimeout(poll, timeout)\n        } else if (img.currentSrc.endsWith('.svg') || img.currentSrc.startsWith('data:image/svg+xml')) {\n          naturalWidth.value = 1\n          naturalHeight.value = 1\n        }\n      }\n\n      poll()\n    }\n\n    const containClasses = toRef(() => ({\n      'v-img__img--cover': props.cover,\n      'v-img__img--contain': !props.cover,\n    }))\n\n    const __image = () => {\n      if (!normalisedSrc.value.src || state.value === 'idle') return null\n\n      const img = (\n        <img\n          class={['v-img__img', containClasses.value]}\n          style={{ objectPosition: props.position }}\n          crossorigin={ props.crossorigin }\n          src={ normalisedSrc.value.src }\n          srcset={ normalisedSrc.value.srcset }\n          alt={ props.alt }\n          referrerpolicy={ props.referrerpolicy }\n          draggable={ props.draggable }\n          sizes={ props.sizes }\n          ref={ image }\n          onLoad={ onLoad }\n          onError={ onError }\n        />\n      )\n\n      const sources = slots.sources?.()\n\n      return (\n        <MaybeTransition transition={ props.transition } appear>\n          {\n            withDirectives(\n              sources\n                ? <picture class=\"v-img__picture\">{ sources }{ img }</picture>\n                : img,\n              [[vShow, state.value === 'loaded']]\n            )\n          }\n        </MaybeTransition>\n      )\n    }\n\n    const __preloadImage = () => (\n      <MaybeTransition transition={ props.transition }>\n        { normalisedSrc.value.lazySrc && state.value !== 'loaded' && (\n          <img\n            class={['v-img__img', 'v-img__img--preload', containClasses.value]}\n            style={{ objectPosition: props.position }}\n            crossorigin={ props.crossorigin }\n            src={ normalisedSrc.value.lazySrc }\n            alt={ props.alt }\n            referrerpolicy={ props.referrerpolicy }\n            draggable={ props.draggable }\n          />\n        )}\n      </MaybeTransition>\n    )\n\n    const __placeholder = () => {\n      if (!slots.placeholder) return null\n\n      return (\n        <MaybeTransition transition={ props.transition } appear>\n          { (state.value === 'loading' || (state.value === 'error' && !slots.error)) &&\n          <div class=\"v-img__placeholder\">{ slots.placeholder() }</div>\n          }\n        </MaybeTransition>\n      )\n    }\n\n    const __error = () => {\n      if (!slots.error) return null\n\n      return (\n        <MaybeTransition transition={ props.transition } appear>\n          { state.value === 'error' &&\n            <div class=\"v-img__error\">{ slots.error() }</div>\n          }\n        </MaybeTransition>\n      )\n    }\n\n    const __gradient = () => {\n      if (!props.gradient) return null\n\n      return <div class=\"v-img__gradient\" style={{ backgroundImage: `linear-gradient(${props.gradient})` }} />\n    }\n\n    const isBooted = shallowRef(false)\n    {\n      const stop = watch(aspectRatio, val => {\n        if (val) {\n          // Doesn't work with nextTick, idk why\n          requestAnimationFrame(() => {\n            requestAnimationFrame(() => {\n              isBooted.value = true\n            })\n          })\n          stop()\n        }\n      })\n    }\n\n    useRender(() => {\n      const responsiveProps = VResponsive.filterProps(props)\n      const [rootAttrs, imageAttrs] = filterInputAttrs(attrs)\n\n      return (\n        <VResponsive\n          class={[\n            'v-img',\n            {\n              'v-img--absolute': props.absolute,\n              'v-img--booting': !isBooted.value,\n            },\n            backgroundColorClasses.value,\n            roundedClasses.value,\n            props.class,\n          ]}\n          style={[\n            { width: convertToUnit(props.width === 'auto' ? naturalWidth.value : props.width) },\n            backgroundColorStyles.value,\n            props.style,\n          ]}\n          { ...responsiveProps }\n          { ...rootAttrs }\n          aspectRatio={ aspectRatio.value }\n          aria-label={ props.alt }\n          role={ props.alt ? 'img' : undefined }\n          v-intersect={[{\n            handler: init,\n            options: props.options,\n          }, null, ['once']]}\n        >{{\n          additional: () => (\n            <>\n              <__image { ...imageAttrs } />\n              <__preloadImage />\n              <__gradient />\n              <__placeholder />\n              <__error />\n            </>\n          ),\n          default: slots.default,\n        }}</VResponsive>\n      )\n    })\n\n    return {\n      currentSrc,\n      image,\n      state,\n      naturalWidth,\n      naturalHeight,\n    }\n  },\n})\n\nexport type VImg = InstanceType<typeof VImg>\n"],"mappings":"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","ignoreList":[]}