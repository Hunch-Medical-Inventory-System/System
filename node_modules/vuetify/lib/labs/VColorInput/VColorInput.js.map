{"version":3,"file":"VColorInput.js","names":["VAvatar","makeVColorPickerProps","VColorPicker","makeVConfirmEditProps","VConfirmEdit","VMenu","makeVTextFieldProps","VTextField","makeFocusProps","useProxiedModel","computed","shallowRef","genericComponent","omit","propsFactory","useRender","availablePipLocations","makeVColorInputProps","hidePip","Boolean","colorPip","pipIcon","type","String","default","pipLocation","validator","v","includes","pipVariant","pickerProps","Object","VColorInput","name","props","emits","val","setup","slots","model","menu","isFocused","focused","isInteractive","disabled","readonly","display","value","onKeydown","e","key","target","onClick","preventDefault","stopPropagation","onSave","onCancel","confirmEditProps","filterProps","colorPickerProps","textFieldProps","slotWithPip","undefined","arg","_createElementVNode","_Fragment","_createVNode","_mergeProps","class","style","event","$event","actions","proxyModel","save","cancel","isPristine","onUpdateModel","hideActions"],"sources":["../../../src/labs/VColorInput/VColorInput.tsx"],"sourcesContent":["// Styles\nimport './VColorInput.sass'\n\n// Components\nimport { VAvatar } from '@/components/VAvatar'\nimport { makeVColorPickerProps, VColorPicker } from '@/components/VColorPicker/VColorPicker'\nimport { makeVConfirmEditProps, VConfirmEdit } from '@/components/VConfirmEdit/VConfirmEdit'\nimport { VMenu } from '@/components/VMenu/VMenu'\nimport { makeVTextFieldProps, VTextField } from '@/components/VTextField/VTextField'\n\n// Composables\nimport { makeFocusProps } from '@/composables/focus'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, shallowRef } from 'vue'\nimport { genericComponent, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { VTextFieldSlots } from '@/components/VTextField/VTextField'\n\nexport type VColorInputActionsSlot = {\n  save: () => void\n  cancel: () => void\n  isPristine: boolean\n}\n\nexport type VColorInputSlots = Omit<VTextFieldSlots, 'default'> & {\n  actions: VColorInputActionsSlot\n  default: never\n}\n\nconst availablePipLocations = ['prepend', 'prepend-inner', 'append', 'append-inner'] as const\nexport type PipLocation = typeof availablePipLocations[number]\n\nexport const makeVColorInputProps = propsFactory({\n  hidePip: Boolean,\n  colorPip: Boolean,\n  pipIcon: {\n    type: String,\n    default: '$color',\n  },\n  pipLocation: {\n    type: String as PropType<PipLocation>,\n    default: 'prepend',\n    validator: (v: any) => availablePipLocations.includes(v),\n  },\n  pipVariant: {\n    type: String as PropType<VAvatar['$props']['variant']>,\n    default: 'text',\n  },\n  pickerProps: Object as PropType<VColorPicker['$props']>,\n\n  ...makeFocusProps(),\n  ...makeVConfirmEditProps(),\n  ...makeVTextFieldProps(),\n  ...omit(makeVColorPickerProps(), [\n    'location',\n    'height',\n    'minHeight',\n    'maxHeight',\n  ]),\n}, 'VColorInput')\n\nexport const VColorInput = genericComponent<VColorInputSlots>()({\n  name: 'VColorInput',\n\n  props: makeVColorInputProps(),\n\n  emits: {\n    'update:modelValue': (val: string) => true,\n  },\n\n  setup (props, { slots }) {\n    const model = useProxiedModel(props, 'modelValue')\n    const menu = shallowRef(false)\n    const isFocused = shallowRef(props.focused)\n\n    const isInteractive = computed(() => !props.disabled && !props.readonly)\n\n    const display = computed(() => model.value || null)\n\n    function onKeydown (e: KeyboardEvent) {\n      if (e.key !== 'Enter') return\n\n      if (!menu.value || !isFocused.value) {\n        menu.value = true\n\n        return\n      }\n\n      const target = e.target as HTMLInputElement\n\n      model.value = target.value\n    }\n\n    function onClick (e: MouseEvent) {\n      e.preventDefault()\n      e.stopPropagation()\n\n      menu.value = true\n    }\n\n    function onSave () {\n      menu.value = false\n    }\n\n    function onCancel () {\n      menu.value = false\n    }\n\n    useRender(() => {\n      const confirmEditProps = VConfirmEdit.filterProps(props)\n      const colorPickerProps = {\n        ...VColorPicker.filterProps(omit(props, [\n          'active',\n          'bgColor',\n          'color',\n          'rounded',\n          'maxWidth',\n          'minWidth',\n          'width',\n        ])),\n        ...props.pickerProps,\n      }\n      const textFieldProps = VTextField.filterProps(props)\n\n      const slotWithPip = props.hidePip\n        ? undefined\n        : {\n          [props.pipLocation]: (arg: any) => (\n            <>\n              <VAvatar\n                class=\"v-color-input__pip\"\n                color={ props.colorPip ? model.value as string : undefined }\n                variant={ props.pipVariant }\n                icon={ props.pipIcon }\n              />\n              { slots[props.pipLocation]?.(arg) }\n            </>\n          ),\n        }\n\n      return (\n        <VTextField\n          { ...textFieldProps }\n          class={[\n            'v-color-input',\n            props.class,\n          ]}\n          style={ props.style }\n          modelValue={ display.value }\n          onKeydown={ isInteractive.value ? onKeydown : undefined }\n          focused={ menu.value || isFocused.value }\n          onClick:control={ !props.disabled ? onClick : undefined }\n          onClick:prependInner={ !props.disabled ? onClick : undefined }\n          onUpdate:focused={ event => isFocused.value = event }\n          onClick:appendInner={ !props.disabled ? onClick : undefined }\n          onUpdate:modelValue={ val => {\n            model.value = val\n          }}\n        >\n          {{\n            ...slots,\n            ...slotWithPip,\n            default: () => (\n              <>\n                <VMenu\n                  v-model={ menu.value }\n                  activator=\"parent\"\n                  minWidth=\"0\"\n                  closeOnContentClick={ false }\n                  openOnClick={ false }\n                >\n                  <VConfirmEdit\n                    { ...confirmEditProps }\n                    v-model={ model.value }\n                    onSave={ onSave }\n                    onCancel={ onCancel }\n                  >\n                    {{\n                      default: ({ actions, model: proxyModel, save, cancel, isPristine }) => {\n                        function onUpdateModel (value: string) {\n                          if (!props.hideActions) {\n                            proxyModel.value = value\n                          } else {\n                            model.value = value\n                          }\n                        }\n\n                        return (\n                          <VColorPicker\n                            { ...colorPickerProps }\n                            modelValue={ props.hideActions ? model.value : proxyModel.value }\n                            onUpdate:modelValue={ value => onUpdateModel(value) }\n                          >\n                            {{\n                              actions: !props.hideActions ? () => slots.actions?.({ save, cancel, isPristine }) ?? actions() : undefined,\n                            }}\n                          </VColorPicker>\n                        )\n                      },\n                    }}\n                  </VConfirmEdit>\n                </VMenu>\n\n                { slots.default?.() }\n              </>\n            ),\n          }}\n        </VTextField>\n      )\n    })\n  },\n})\n\nexport type VColorInput = InstanceType<typeof VColorInput>\n"],"mappings":"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","ignoreList":[]}