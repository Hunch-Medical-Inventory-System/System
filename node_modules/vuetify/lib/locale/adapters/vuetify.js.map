{"version":3,"file":"vuetify.js","names":["useProxiedModel","ref","shallowRef","toRef","watch","consoleError","consoleWarn","getObjectValueByPath","en","LANG_PREFIX","replace","str","params","match","index","String","Number","createTranslateFunction","current","fallback","messages","key","startsWith","shortKey","currentLocale","value","fallbackLocale","createNumberFunction","options","numberFormat","Intl","NumberFormat","format","inferDecimalSeparator","includes","useProvided","props","prop","provided","internal","v","createProvideFunction","state","name","decimalSeparator","t","n","provide","createVuetifyAdapter","locale"],"sources":["../../../src/locale/adapters/vuetify.ts"],"sourcesContent":["// Composables\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { ref, shallowRef, toRef, watch } from 'vue'\nimport { consoleError, consoleWarn, getObjectValueByPath } from '@/util'\n\n// Locales\nimport en from '@/locale/en'\n\n// Types\nimport type { Ref } from 'vue'\nimport type { LocaleInstance, LocaleMessages, LocaleOptions } from '@/composables/locale'\n\nconst LANG_PREFIX = '$vuetify.'\n\nconst replace = (str: string, params: unknown[]) => {\n  return str.replace(/\\{(\\d+)\\}/g, (match: string, index: string) => {\n    return String(params[Number(index)])\n  })\n}\n\nconst createTranslateFunction = (\n  current: Ref<string>,\n  fallback: Ref<string>,\n  messages: Ref<LocaleMessages>,\n) => {\n  return (key: string, ...params: unknown[]) => {\n    if (!key.startsWith(LANG_PREFIX)) {\n      return replace(key, params)\n    }\n\n    const shortKey = key.replace(LANG_PREFIX, '')\n    const currentLocale = current.value && messages.value[current.value]\n    const fallbackLocale = fallback.value && messages.value[fallback.value]\n\n    let str: string = getObjectValueByPath(currentLocale, shortKey, null)\n\n    if (!str) {\n      consoleWarn(`Translation key \"${key}\" not found in \"${current.value}\", trying fallback locale`)\n      str = getObjectValueByPath(fallbackLocale, shortKey, null)\n    }\n\n    if (!str) {\n      consoleError(`Translation key \"${key}\" not found in fallback`)\n      str = key\n    }\n\n    if (typeof str !== 'string') {\n      consoleError(`Translation key \"${key}\" has a non-string value`)\n      str = key\n    }\n\n    return replace(str, params)\n  }\n}\n\nfunction createNumberFunction (current: Ref<string>, fallback: Ref<string>) {\n  return (value: number, options?: Intl.NumberFormatOptions) => {\n    const numberFormat = new Intl.NumberFormat([current.value, fallback.value], options)\n\n    return numberFormat.format(value)\n  }\n}\n\nfunction inferDecimalSeparator (current: Ref<string>, fallback: Ref<string>) {\n  const format = createNumberFunction(current, fallback)\n  return format(0.1).includes(',') ? ',' : '.'\n}\n\nfunction useProvided <T> (props: any, prop: string, provided: Ref<T>) {\n  const internal = useProxiedModel(props, prop, props[prop] ?? provided.value)\n\n  // TODO: Remove when defaultValue works\n  internal.value = props[prop] ?? provided.value\n\n  watch(provided, v => {\n    if (props[prop] == null) {\n      internal.value = provided.value\n    }\n  })\n\n  return internal as Ref<T>\n}\n\nfunction createProvideFunction (state: { current: Ref<string>, fallback: Ref<string>, messages: Ref<LocaleMessages> }) {\n  return (props: LocaleOptions): LocaleInstance => {\n    const current = useProvided(props, 'locale', state.current)\n    const fallback = useProvided(props, 'fallback', state.fallback)\n    const messages = useProvided(props, 'messages', state.messages)\n\n    return {\n      name: 'vuetify',\n      current,\n      fallback,\n      messages,\n      decimalSeparator: toRef(() => inferDecimalSeparator(current, fallback)),\n      t: createTranslateFunction(current, fallback, messages),\n      n: createNumberFunction(current, fallback),\n      provide: createProvideFunction({ current, fallback, messages }),\n    }\n  }\n}\n\nexport function createVuetifyAdapter (options?: LocaleOptions): LocaleInstance {\n  const current = shallowRef(options?.locale ?? 'en')\n  const fallback = shallowRef(options?.fallback ?? 'en')\n  const messages = ref({ en, ...options?.messages })\n\n  return {\n    name: 'vuetify',\n    current,\n    fallback,\n    messages,\n    decimalSeparator: toRef(() => options?.decimalSeparator ?? inferDecimalSeparator(current, fallback)),\n    t: createTranslateFunction(current, fallback, messages),\n    n: createNumberFunction(current, fallback),\n    provide: createProvideFunction({ current, fallback, messages }),\n  }\n}\n"],"mappings":"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","ignoreList":[]}